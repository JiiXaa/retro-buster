{% extends "base.html" %}
{% block content %}

<h1>{{ movie.title|title }} Details</h1>

<div class="movie-actions__wrapper">
  <a href="{{ url_for('movies.movie_edit', movie_id=movie.id) }}" aria-label="Edit movie">
    <i class="fa-regular fa-pen-to-square" aria-hidden="true"></i>
    <span class="visually-hidden">Edit</span>
  </a>
  <a href="{{ url_for('movies.movie_delete', movie_id=movie.id) }}" aria-label="Delete movie">
    <i class="fa-solid fa-trash" aria-hidden="true"></i>
    <span class="visually-hidden">Delete</span>
  </a>
</div>
<p>Director: {{ movie.director|title }}</p>
<p>Genre: {{ movie.genre|title }}</p>
<p>Total copies: {{ movie.total_count() }}</p>
<p>Available copies: {{ movie.available_count() }}</p>

<h3>VHS copy details:</h3>
<table>
  <tr>
    <th>Copy number</th>
    <th>Is available</th>
    <th>Rent</th>
    <th>History</th>
    <th>Actions</th>
  </tr>

  {% for vhs_tape in movie.vhs_tape_copy %}
    <!-- Display only VHS tapes that have not been deleted. -->
    {% if vhs_tape.is_removed == False %}
      <tr>
        <td>{{ vhs_tape.copy_number }}</td>
        <td>{% if vhs_tape.is_available %}
            Yes
        {% else %}
            No
        {% endif %}
        </td>
        <td>
          {% if vhs_tape.is_available %}
            <a href="{{ url_for('movies.vhs_rent', movie_id=movie.id, vhs_tape_copy_id=vhs_tape.id) }}">Rent</a>
          {% else %}
            <a href="{{ url_for('movies.vhs_return', movie_id=movie.id, vhs_tape_copy_id=vhs_tape.id) }}">Return</a>
          {% endif %}
        </td>
        <td>
          <a href="{{ url_for('movies.vhs_history', movie_id=movie.id, vhs_tape_copy_id=vhs_tape.id) }}">History</a>
        </td>
        <td>
          <a href="{{ url_for('movies.vhs_remove', movie_id=movie.id, vhs_tape_copy_id=vhs_tape.id) }}">Delete</a>
        </td>
      </tr>
    {% endif %}
    {% endfor %}

    {% if movie.available_count() == 0 %}
      <tr>
        <td colspan="5">No VHS copies available.</td>
      </tr>
    {% endif %}
</table>

<a href="{{ url_for('movies.vhs_add_tape', movie_id=movie.id) }}">Add VHS copy</a>

{% endblock %}